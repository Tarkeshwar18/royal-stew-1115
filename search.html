<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search</title>
    <link rel="stylesheet" href="search.css" class="css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300&family=Mulish:wght@700&family=Poppins:wght@100;200&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
</head>
<body>
    <div class="search_bar">
        <div id="search_input">
            <!-- <h5>Search</h5> -->
            <div class="main_search">
                <input type="text" placeholder="Search" id="product_searchBar">
                <i class="fa-solid fa-magnifying-glass" id="seach-icon" onclick="filter()"></i>
            </div> 
        </div>
    </div>
    <div class="sortDiv">
       <button id="lowTohigh" class="button-grow">Low To High</button>
       <button id="highTolow" class="button-grow">High To Low</button>
    </div>
    <div id="search_result_div">

    </div>
</body>
</html>
<script>
    // ............................................search page functionality .....................................................

    let url =  "https://63c788db5c0760f69ab9188f.mockapi.io/products";

    let icon = document.getElementById("seach-icon");
    let main = document.getElementById("search_result_div");
    let sorting = document.getElementById("sortByprice");
    let lowTohigh = document.getElementById("lowTohigh");
    let highTolow = document.getElementById("highTolow");
    let new_data = []
    let productList = []
    let sortList = []
    fetch(url)
    .then(res => res.json())
    .then((data)=>{
        
        productList = data.map((item)=>{
           return{
            image: `${item.image}`,
            title:item.title,
            descreption: item.descreption,
            category:item.category,
            price:item.price
           }
        })
        sortList=productList
    })


    
    lowTohigh.addEventListener("click",()=>{
            main.innerHTML=null
           let sortarr = new_data.sort((a,b)=>{
            if(a===b){
                return 0;
            }
            else{
                return +(a.price) < +(b.price) ? -1 : 1;
            }
           })
       
           filterDataclick(sortarr);
        
    });
    highTolow.addEventListener("click",()=>{
            main.innerHTML=null
           let sortarr = new_data.sort((a,b)=>{
            if(a===b){
                return 0;
            }
            else{
                return +(b.price) < +(a.price) ? -1 : 1;
            }
           })
          
           filterDataclick(sortarr);
        
    });

    function filter(){
        let searchValue = document.getElementById("product_searchBar").value;
        main.innerHTML = null;

        new_data = productList.filter((item,ind)=>{
         if(searchValue.toLowerCase() === item.category.toLowerCase()){
             return item.category.trim().toLowerCase().includes(searchValue.trim().toLowerCase())
         }
        })
        filterDataclick(new_data)

    }
    

    function filterDataclick(new_data){

        new_data.forEach(ele=>{
            let card_list = document.createElement("div");
            card_list.setAttribute("id","card-list");

            let card = document.createElement("div");
            card.setAttribute("class","productCard")

            let imgdiv=document.createElement("div");
            imgdiv.setAttribute("class","img-div")

            let image = document.createElement("img");
            image.setAttribute("src",ele.image);
            imgdiv.append(image);

            let detail_div=document.createElement("div");
            detail_div.setAttribute("class","detail_div")
            let price = document.createElement("h4");
            price.innerText="Rs. "+ ele.price;

            let descreption = document.createElement("p");
            descreption.innerText = ele.descreption;
            let btn=document.createElement("button");
            btn.innerText="Add To Cart"
            detail_div.append(price,descreption,btn)

            card.append(imgdiv,detail_div)
            card_list.append(card)
            main.append(card_list);
        })
    }
   

</script>